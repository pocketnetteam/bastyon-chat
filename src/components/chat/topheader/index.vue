<template>
	<div id="chatTopheader">

		<topheader v-if="chat || u">
			<template v-slot:left>
				<backButton action="chats" />
			</template>

			<template v-slot:leftadd>
				<search chat="true" :minimize="!matches.value" />
			</template>

			<template v-slot:info>
				<router-link v-if="chat" :to="'chatInfo?id=' + chat.roomId">
					<div v-if="m_chat">
						<div class="nameWrapper">
							<chatName
								:preview="true"
								:chat="chat"
								:m_chat="m_chat"
								v-if="!roomInfo"
							/>
							<div class="roomMuted" v-if="roomMuted">
								<i class="fas fa-bell-slash"></i>
							</div>
						</div>
						<transition name="fade">
							<chatTyping v-if="m_chat_typing" />
						</transition>
					</div>

					<div v-if="!m_chat && userinfo">
						<span class="nameline">{{ userinfo.name }}</span>
					</div>
				</router-link>
			</template>

			<template v-slot:rightadd v-if="callsEnabled">
				<div
					v-if="isCallsActive && !isGroup"
					class="call btn iconbutton"
					:class="
						checkCallsEnabled() === 'wait' || wait
							? 'wait'
							: checkCallsEnabled()
							? ''
							: 'disabled'
					"
					:title="
						checkCallsEnabled() === 'wait' || wait
							? $t('caption.wait')
							: checkCallsEnabled()
							? ''
							: $t('caption.disabled')
					"
					@click="bcCall"
				>
					<i class="fas fa-video"></i>
          {{lastEnabled? '': ''}}
				</div>
			</template>

			<template v-slot:right>
				<router-link v-if="chat" :to="'chatInfo?id=' + chat.roomId">
					<div class="iconbutton"><i class="fas fa-ellipsis-h"></i></div>
				</router-link>
			</template>
		</topheader>

	</div>
</template>

<script src="./index.js"></script>
<style scoped lang="sass" src="./index.sass"></style>

<!-- THEMES BEGIN -->
<!-- THEMES END -->
